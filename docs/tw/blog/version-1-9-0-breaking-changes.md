---
category: [開發日誌]
order: 1
comment: false
description: 本文內容適用於Snap Hutao **1.4.11~1.8.4 版本**升級至 1.9.0 及更高版本
---

# 1.9.0 版本重大改變詳解

本文內容適用於Snap Hutao **1.4.11~1.8.4 版本**升級至 1.9.0 及更高版本

::: warning 本文已歸檔

本頁面已歸檔。如需安裝 Snap Hutao，請前往[快速開始](../quick-start.md)獲取信息。

:::

## 前言

Snap Hutao 是一個使用 MSIX 格式的 Windows 沙盒應用，它帶來了安裝的便利性和 AppX 應用的安全性。對安裝包強制性的代碼簽名是保證安全性的重要因素之一：在安裝包被篡改時，Windows App Installer 會因為簽名被破壞而彈出錯誤，進而禁止用戶安裝，這在主流移動端操作系統中已經被普及。在 Windows 平臺下，由於嚴格的身份審查制度，代碼簽名證書價格一直保持在很高的價格上。

Snap Hutao 在1.4.11版本前，使用了自簽名證書的方法。在這種模式下，用戶需要手動安裝 DGP-Studio 的證書，才能讓操作系統允許 DGP-Studio 證書籤名的應用安裝於計算機上。自1.4.11版本起，Snap Hutao 上架微軟商店，微軟為胡桃的開發者賬號提供了一個 GUID `35C8E923-85DF-49A7-9172-B39DC6312C52` 並以此為用戶名為胡桃工具箱提供了免費的簽名。如果你習慣使用 msix 安裝包更新胡桃工具箱，那麼你應總是能在發佈者一欄中看到這個 GUID。

在微軟商店發佈使得胡桃工具箱的用戶不再需要手動安裝簽名證書，還為胡桃工具箱安裝包的分發提供了支持，為開發團隊降低了大量的成本。但是，繁瑣冗長的審核流程經常打亂胡桃工具箱的開發計劃，因此開發團隊在過去的半年中一直在尋找解決方案。SignPath 是一家位於奧地利維也納的提供代碼簽名集成軟件的公司。在2023年12月初，Snap Hutao 的開發團隊成功地獲取到了 SignPath 基金會的支持，被允許免費使用其提供的代碼簽名證書為胡桃工具箱簽名。這極大地幫助了 Snap Hutao 項目：不僅允許胡桃工具箱脫離微軟商店的束縛，還避免了每年高昂的證書費用。

**由於遷移至新證書會帶來包名衝突問題，Snap Hutao 提供以下詳細解釋幫助所有用戶更新至 1.9.0 及未來的版本。**

## 升級至 1.9.0 版本

### 版本發佈

Snap Hutao 1.9.0 版本將會於2023年聖誕節前的週末發佈，我們會通過 GitHub，極狐GitLab，官方網站和社區發佈安裝包的下載地址。

> 1.9.0 版本已發佈，請在[快速開始](../quick-start.md#全新安裝)頁面獲取

### 卸載舊版本

由於包名和簽名衝突，直接安裝該安裝包會根據你的系統版本出現問題。

|  系統版本  |                           預計的問題                            |
| :--------: | :-------------------------------------------------------------: |
| Windows 10 |                    無法安裝；簽名和包名衝突                     |
| Windows 11 | 安裝成功；<br/>與舊版本的 Snap Hutao 同名共存並造成程序運行錯誤 |

由於上述的問題，你需要首先卸載舊版本 Snap Hutao，隨後再安裝 1.9.0 版本安裝包

> **卸載 Snap Hutao 的方法**：在開始菜單找到 Snap Hutao，右鍵點擊卸載即可；在 Windows 應用設置中找到後選擇卸載亦是快捷的方法。

**你的重要數據（包括已登錄的米遊社賬號、祈願記錄、成就數據、深境螺旋挑戰記錄、我的角色緩存數據、養成計劃）不會丟失，它們仍然儲存於你的本地計算機胡桃數據目錄中。** 但以下數據將被重置：

1. Snap Hutao 運行次數計數
2. 數據文件夾路徑 **（如果你之前修改了數據目錄，請記住你的數據目錄路徑）**
3. 胡桃賬號登錄狀態
4. 已關閉的胡桃公告標記
5. 養成計劃預設等級信息
6. 主頁儀表盤卡片的狀態
7. 自動連點功能的狀態

### 安裝新版本

![1.8.5版本安裝文件](/images/202312/1-8-5-installer.png)

運行你已經下載好的 1.9.0 版本安裝包，在安裝界面你應能看到發佈者為 `SignPath Foundation`，點擊安裝你就可以安裝全新版本的 Snap Hutao 了！

**如果你在舊版本修改了數據目錄位置，需要在啟動後重新在設置中選擇數據目錄路徑以恢復數據。若從未設置過數據目錄，你的數據將會直接加載，不需要進行額外設置。**

## 未來的計劃

> 微軟商店、未來的發佈、軟件的安全性...

微軟商店中上架的應用發佈者名稱必須為微軟賦予的 GUID，而不能是 `SignPath Foundation` 這樣的“自定義”的名稱。我們預計未來不會在微軟商店中繼續發佈更新的版本，除非我們有更好的方法處理不同簽名包之間的共存問題。雖然 Snap Hutao 不再經過微軟的認證，但是在 SignPath 的限制下，Snap Hutao 將只能從 GitHub 代碼庫直接編譯和構建發佈包，這意味著用戶的安裝包中的代碼是 100% 來源於我們的 GitHub 代碼庫，任何人都有權限審閱代碼並參與開發。

自1.9.0版本起的客戶端，我們將內置軟件更新模塊以適應新的發佈方式，我們會盡可能減少用戶更新時所需要的操作。由於該功能是全新的功能，我們仍在部署過程中，請繼續關注我們的程序內公告和社區以獲取信息！
